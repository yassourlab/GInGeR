INFO:reference_database_utils:running kraken: kraken2 --db /sci/labs/morani/morani/icore-data/lab/Tools/kraken2_db/UnifiedHumanGastrointestinalGenome --paired /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/pipeline_tree/zymo_standard/data/short_reads/ERR2984773_Illumina_MiSeq_paired_end_sequencing_1_sample_1000000.fastq.gz /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/pipeline_tree/zymo_standard/data/short_reads/ERR2984773_Illumina_MiSeq_paired_end_sequencing_2_sample_1000000.fastq.gz --threads 16 --output /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/kraken_folder/kraken_output_file.tsv --use-names
INFO:reference_database_utils:b''
INFO:reference_database_utils:['Staphylococcus aureus', 'Enterococcus faecalis', 'Escherichia coli_D', 'Listeria monocytogenes_B', 'Bacillus subtilis', 'Salmonella enterica', 'Limosilactobacillus fermentum', 'Pseudomonas aeruginosa']
INFO:reference_database_utils:MGYG000020347.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000145992.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000158449.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000135497.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000098760.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000249513.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000220217.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000197288.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000098079.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000020533.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000264664.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000011999.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000194714.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000174999.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000195133.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000035936.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000008938.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000179393.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000213410.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000030701.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000260594.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000150245.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000175483.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000005504.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000132142.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000029367.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000136185.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000222001.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000153365.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000273917.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000002325.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000239712.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000170034.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000008816.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000177350.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000091734.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000197954.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000000012.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000161712.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000074081.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000247301.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000080131.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000049865.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000162794.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000191851.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000180855.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000170281.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000037043.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000000166.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000005821.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000051262.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000096037.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000258283.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000136034.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000204966.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000140450.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000017137.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000248618.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000211343.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:reference_database_utils:MGYG000239531.gff.gz in /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/references_folder/
INFO:ginger:$$$$$$$$$$ database filtering took 1.1605396370481078 minutes $$$$$$$$$$
INFO:sequence_alignment_utils:2022-11-07 18:23:28.977609 running minimap2 indexing: minimap2 -x asm20 -d /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/kraken_folder/merged_filtered_ref_db.mmi /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/kraken_folder/merged_filtered_ref_db.fasta
INFO:root:minimap2 run successfully. stdout: b''
INFO:ginger:$$$$$$$$$$ indexing reference database took 0.20359495484735818 minutes $$$$$$$$$$
INFO:hybrid_assembly_utils:running MetaSPAdes - spades.py --meta -1 /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/pipeline_tree/zymo_standard/data/short_reads/ERR2984773_Illumina_MiSeq_paired_end_sequencing_1_sample_1000000.fastq.gz -2 /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/pipeline_tree/zymo_standard/data/short_reads/ERR2984773_Illumina_MiSeq_paired_end_sequencing_2_sample_1000000.fastq.gz --nanopore /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/pipeline_tree/zymo_standard/data/long_reads/ERR3152364_GridION_sequencing_sample_250000.fastq.gz -o /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/hybrid_spades -t 16
INFO:ginger:$$$$$$$$$$ running assembly took 14.742268094513566 minutes $$$$$$$$$$
INFO:process_context_candidates:2022-11-07 18:38:31.702965 mapping genes to contigs
INFO:root:running minimap2: minimap2 -cx asm20 -t 16 /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/hybrid_spades/contigs.fasta /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/pipeline_tree/genes_from_amir_erez/processed/genes_without_dup_locations.fasta > /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/genes_to_contigs.paf -P
INFO:root:minimap2 run successfully. stdout: b''
INFO:process_context_candidates:2022-11-07 18:38:33.246367 extracting in and out paths
INFO:process_context_candidates:2022-11-07 18:38:42.679785 mapping in and out paths
INFO:root:running minimap2: minimap2 -cx asm20 -t 16 /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/kraken_folder/merged_filtered_ref_db.mmi /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/all_in_paths.fasta > /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/in_paths_to_reference.paf -P
INFO:root:minimap2 run successfully. stdout: b''
INFO:root:running minimap2: minimap2 -cx asm20 -t 16 /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/kraken_folder/merged_filtered_ref_db.mmi /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/all_out_paths.fasta > /sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/test_run/out_paths_to_reference.paf -P
INFO:root:minimap2 run successfully. stdout: b''
INFO:process_context_candidates:2022-11-07 18:40:23.469722 parsing the mapping of in and out paths
INFO:process_context_candidates:found 223370 matches for 49052 gene-bug pairs
INFO:process_context_candidates:found 226854 matches for 48842 gene-bug pairs
INFO:process_context_candidates:2022-11-07 18:40:45.550814 generating in-out matches
Traceback (most recent call last):
  File "/sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/GInGeR/run_ginger_from_python.py", line 32, in <module>
    ginger_results = ginger.run_ginger_e2e(long_reads, short_reads_1, short_reads_2, output_folder, assembly_folder,
  File "/sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/GInGeR/ginger.py", line 90, in run_ginger_e2e
    results = iopa.run_in_out_paths_approach(assembly_folder, genes_path, indexed_reference, threads, depth_limit,
  File "/sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/GInGeR/process_context_candidates.py", line 218, in run_in_out_paths_approach
    return process_in_and_out_paths_to_results(in_mapping_to_bugs_path, out_mapping_to_bugs_path, genes_lengths,
  File "/sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/GInGeR/process_context_candidates.py", line 293, in process_in_and_out_paths_to_results
    matches_per_gene = get_all_in_out_matches(parsed_in_path_to_bugs_by_gene_and_bug,
  File "/sci/labs/morani/morani/icore-data/lab/Projects/hybrid_assembler/GInGeR/process_context_candidates.py", line 256, in get_all_in_out_matches
    in_out_match = get_in_out_match(i, o, genes_lengths[i.gene], minimal_gap_ratio, maximal_gap_ratio)
KeyError: 'Subject_C3030__Scaffold_145__Start_46463__End_48259'
